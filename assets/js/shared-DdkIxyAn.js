import{C as z,G as v,T,M as E,B as k,V as g,F as M,P,a as L,b as y,c as p}from"./vendor-three-mP7boBGq.js";class _{constructor(s,t){this.camera=s,this.domElement=t,this.isDragging=!1,this.previousMousePosition={x:0,y:0},this.addEventListeners()}addEventListeners(){this.domElement.addEventListener("mousedown",this.onMouseDown.bind(this)),this.domElement.addEventListener("mousemove",this.onMouseMove.bind(this)),this.domElement.addEventListener("mouseup",this.onMouseUp.bind(this)),this.domElement.addEventListener("wheel",this.onMouseWheel.bind(this)),window.addEventListener("keydown",this.onKeyDown.bind(this))}onMouseDown(s){this.isDragging=!0,this.previousMousePosition={x:s.clientX,y:s.clientY}}onMouseMove(s){if(!this.isDragging)return;const t={x:s.clientX-this.previousMousePosition.x,y:s.clientY-this.previousMousePosition.y},e=.005;this.camera.camera.rotation.y-=t.x*e,this.camera.camera.rotation.x-=t.y*e,this.previousMousePosition={x:s.clientX,y:s.clientY}}onMouseUp(){this.isDragging=!1}onMouseWheel(s){this.camera.camera.position.z+=s.deltaY*.01}onKeyDown(s){switch(s.key){case"ArrowUp":this.camera.camera.position.z-=.1;break;case"ArrowDown":this.camera.camera.position.z+=.1;break;case"ArrowLeft":this.camera.camera.position.x-=.1;break;case"ArrowRight":this.camera.camera.position.x+=.1;break}}}class F{constructor(s,t,e){this.scene=s,this.camera=t,this.renderer=e,this.clock=new z,this.updatableLists=[]}start(){const s=this.renderer,t=this.camera;s.renderer.setAnimationLoop(()=>{this.tick(),s.renderer.render(this.scene.scene,t.camera)}),this.clock.getDelta()}tick(){const s=this.clock.getDelta();this.updatableLists.forEach(t=>{t.forEach(e=>e.tick(s))})}stop(){this.renderer.renderer.setAnimationLoop(null)}}async function B(c,s,t,e={}){const i=new v;function n(a){return new Promise((r,l)=>{i.load(a,m=>{r(m)},void 0,m=>{l(m)})})}function o(a){a.traverse(r=>{if(r.isMesh){const l=r;l.castShadow=!0,l.receiveShadow=!0}})}const h=["barrelTSCP","boatTSCP","bottom","building1TSCP","building2TSCP","burger","bus2TSCP","car2","chair1","checkPoint","chum_bucket","clock","fish","hat","house1","jelly_fish","karen","krabTSCP","lightHouseTSCP","mill1","mill2","patrickStatue","pillar","pineapple_house","rock","snailClock","spatula","spongehengeTSCP","squidwardHouseTSCP","swimmingRing","table","tableTSCP","tiki_wood","train","wooden_fence","krabDollar","krabMenu","mrKrab","krabPack","krabTable","jellyNet","jellyfish3","butterfly","tomb"],x=["roboBob1","roboBob2","doodleBob","spongebobDraw","phantomBob","realBob","scaryBob1","scaryBob2","spongeBobAll","parickHorse","patrickAll","patrickRobot","roboBob3"],u=["sauceTSCP","sodaTSCP","disco_ball","guess_box","xbox_controller_lp","star"],d=[];x.forEach(a=>{d.push(n(`assets_/models/Bobs/${a}/scene.gltf`).then(r=>{o(r.scene),c[a]=r,console.log("Loaded GLTF model:",a,r)}))}),h.forEach(a=>{d.push(n(`assets_/models/obstacles/${a}/scene.gltf`).then(r=>{o(r.scene),s[a]=r,console.log("Loaded GLTF model:",a,r);let l=0;r.scene.traverse(m=>{m.isMesh?l+=m.geometry.attributes.position.count:m.traverse(b=>{b.isMesh&&(l+=b.geometry.attributes.position.count)})}),console.log("Vertex count:",a,l)}))}),u.forEach(a=>{d.push(n(`assets_/models/Items/${a}/scene.gltf`).then(r=>{o(r.scene),t[a]=r,console.log("Loaded GLTF model:",a,r)}))});const f=["wood","block","glass","grass","particle","flower","flower2","sand","road","ice","colorful"],w=new T;function S(a){return new Promise((r,l)=>{w.load(a,m=>{r(m)},void 0,m=>{l(m)})})}f.forEach(a=>{d.push(S(`assets_/textures/${a}.png`).then(r=>{e[a]=r,console.log("Loaded texture:",a)}))}),await Promise.all(d),c=Object.keys(c).sort().reduce((a,r)=>(a[r]=c[r],a),{}),s=Object.keys(s).sort().reduce((a,r)=>(a[r]=s[r],a),{})}function D(c){const s=c.scene.clone(!0),t=c.animations.map(e=>e.clone());return s.traverse(e=>{e instanceof E&&(e.geometry=e.geometry.clone(),Array.isArray(e.material)?e.material=e.material.map(i=>i.clone()):e.material=e.material.clone())}),s.updateMatrixWorld(!0),{...c,scene:s,animations:t}}class j{constructor(){this.duration=0,this.elapsedTime=0,this.velocities=[]}createBreakEffect(s,t=100,e=1){this.duration=e,this.elapsedTime=0;const i=new k,n=[];this.velocities=[];for(let h=0;h<t;h++)n.push(s.x,s.y,s.z),this.velocities.push(new g((Math.random()-.5)*2,(Math.random()-.5)*2,(Math.random()-.5)*2));i.setAttribute("position",new M(n,3));const o=new P({color:16711680,size:.1});this.particles=new L(i,o)}createWindEffect(s,t,e=100,i=1,n=new g(1,0,0)){this.duration=i,this.elapsedTime=0;const o=new k,h=[];this.velocities=[];for(let u=0;u<e;u++){const d=y.lerp(s.x,t.x,Math.random()),f=y.lerp(s.y,t.y,Math.random()),w=y.lerp(s.z,t.z,Math.random());h.push(d,f,w),this.velocities.push(n.clone().multiplyScalar(Math.random()*2))}o.setAttribute("position",new M(h,3));const x=new P({color:8900346,size:.1,transparent:!0,opacity:.5});this.particles=new L(o,x),console.log("particles",this.particles)}update(s){if(this.elapsedTime+=s,this.elapsedTime>=this.duration)return!1;const t=this.particles.geometry.attributes.position.array;for(let e=0;e<t.length;e+=3)t[e]+=this.velocities[e/3].x*s,t[e+1]+=this.velocities[e/3].y*s,t[e+2]+=this.velocities[e/3].z*s;return this.particles.geometry.attributes.position.needsUpdate=!0,!0}addToUpdateList(s){const t=new z,e=()=>{const i=t.getDelta();this.update(i)?requestAnimationFrame(e):s.remove(this.particles)};e()}}class G{constructor(){this.keys={},this.addEventListeners()}addEventListeners(){window.addEventListener("keydown",s=>{this.keys[s.key]=!0}),window.addEventListener("keyup",s=>{this.keys[s.key]=!1})}isKeyPressed(s){return this.keys[s]||!1}}function U(c){const i=(1664525*c+1013904223)%4294967296;return{random:i/4294967296,newSeed:i}}function H(c,s){const t=new p().setFromObject(c.mesh),e=new p().setFromObject(s.mesh);return t.intersectsBox(e)}function K(c,s,t){const e=new p().setFromObject(s.mesh),i=.1;for(const n in t){t[n];const o=new p().setFromObject(c.mesh);if(n=="forward"){if(e.min.z+i<o.max.z)continue;o.max.z+=e.min.z-o.max.z+i,o.min.z+=e.min.z-o.min.z+i,o.intersectsBox(e)&&(t[n]=Math.min(e.min.z,t[n]))}else if(n=="backward"){if(e.max.z-i>o.min.z)continue;o.max.z+=e.max.z-o.max.z-i,o.min.z+=e.max.z-o.min.z-i,o.intersectsBox(e)&&(t[n]=Math.max(e.max.z,t[n]))}else if(n=="left"){if(e.max.x-i>o.min.x)continue;o.max.x+=e.max.x-o.max.x-i,o.min.x+=e.max.x-o.min.x-i,o.intersectsBox(e)&&(t[n]=Math.max(e.max.x,t[n]))}else if(n=="right"){if(e.min.x+i<o.max.x)continue;o.max.x+=e.min.x-o.max.x+i,o.min.x+=e.min.x-o.min.x+i,o.intersectsBox(e)&&(t[n]=Math.min(e.min.x,t[n]))}else if(n=="up"){if(e.min.y+i<o.max.y)continue;o.max.y+=e.min.y-o.max.y+i,o.min.y+=e.min.y-o.min.y+i,o.intersectsBox(e)&&(t[n]=Math.min(e.min.y,t[n]))}else if(n=="down"){if(e.max.y-i>o.min.y)continue;o.max.y+=e.max.y-o.max.y-i,o.min.y+=e.max.y-o.min.y-i,o.intersectsBox(e)&&(t[n]=Math.max(e.max.y,t[n]))}}}export{_ as C,G as I,F as L,j as P,H as a,D as c,B as l,U as s,K as u};
